<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>提取中国省/市/县shp文件</title>
    <url>/2022/04/04/2022-04-04-shapefile/</url>
    <content><![CDATA[<h2 id="今天跟同学讨论提取中国各省的shp文件时总结了两种方法"><a href="#今天跟同学讨论提取中国各省的shp文件时总结了两种方法" class="headerlink" title="今天跟同学讨论提取中国各省的shp文件时总结了两种方法"></a>今天跟同学讨论提取中国各省的shp文件时总结了两种方法</h2><h3 id="1-使用MeteoInfo软件提取shp文件"><a href="#1-使用MeteoInfo软件提取shp文件" class="headerlink" title="1.使用MeteoInfo软件提取shp文件"></a>1.使用MeteoInfo软件提取shp文件</h3><p>首先在<a href="http://www.gadm.org/">地理信息网</a>下载所需底图文件. （PS: 我测试多次都无法直接下载，建议从<a href="http://bbs.06climate.com/forum.php?mod=viewthread&tid=22156">气象家园</a>下载）</p>
<p>接下来在<a href="http://meteothink.org/">MeteoInfo</a>中打开 <strong>bou2_4l.shp</strong> 和 <strong>BOUNT_ploy.shp</strong> 文件</p>
<img src="/2022/04/04/2022-04-04-shapefile/MeteoInfo1.png" class="">
<span id="more"></span>
<p>为了方便区分各省，将 <strong>bou2_4l.shp</strong> 的线条设置为红色并应用</p>
<img src="/2022/04/04/2022-04-04-shapefile/MeteoInfo2.png" class="">

<p>接下来在左侧 <strong>Map Frame</strong> 中选中 <strong>BOUNT_ploy.shp</strong> , 点击工具栏中的 <strong>“要素属性”</strong>工具<br>选中待提取省份的任意区域，以<strong>江苏省</strong>为例，查询到其<strong>SH2</strong>值为32</p>
<img src="/2022/04/04/2022-04-04-shapefile/MeteoInfo3.png" class="">

<p>点击 <strong>“选择-通过属性数据选择”</strong> 在下方文字框中输入 <strong>SH2 = “32”</strong> （也可以从面板操作）,并点击 <strong>select</strong> 按钮(可以勾选 Only selection visible 选项，将未选中的地区mask掉)</p>
<img src="/2022/04/04/2022-04-04-shapefile/MeteoInfo4.png" class="">

<p>最后点击 <strong>“工具-输出地图数据”</strong>  <strong>Map Layer</strong>选择<strong>BOUNT_ploy.shp</strong>，<strong>Output Format</strong>选择<strong>Shape File</strong>然后输出文件<br>这样我们就得到了<strong>江苏省</strong>的shp文件</p>
<img src="/2022/04/04/2022-04-04-shapefile/MeteoInfo5.png" class="">

<h3 id="2-使用网站快速导出"><a href="#2-使用网站快速导出" class="headerlink" title="2.使用网站快速导出"></a>2.使用网站快速导出</h3><p>打开<a href="http://datav.aliyun.com/portal/school/atlas/area_selector">阿里云数据可视化平台</a>,选择需要导出shp文件的省份，并下载<strong>json</strong>文件</p>
<img src="/2022/04/04/2022-04-04-shapefile/WayTwo1.png" class="">

<p>进入<a href="https://mapshaper.org/">Mapshaper</a>网站，导入刚才下载的<strong>json</strong>文件，点击右上角<strong>Export</strong>，选择<strong>File Format</strong>为<strong>Shape File</strong>，点击<strong>Export</strong>输出<br>这样我们就得到了<strong>对应省份</strong>的shp文件</p>
<img src="/2022/04/04/2022-04-04-shapefile/WayTwo2.png" class="">]]></content>
      <categories>
        <category>工具</category>
      </categories>
      <tags>
        <tag>shp</tag>
      </tags>
  </entry>
  <entry>
    <title>EOF分析（PCA主成分分析）</title>
    <url>/2022/04/06/2022-04-06-EOF/</url>
    <content><![CDATA[<h2 id="1-详细介绍EOF分析方法（也称PCA主成分分析）"><a href="#1-详细介绍EOF分析方法（也称PCA主成分分析）" class="headerlink" title="1.详细介绍EOF分析方法（也称PCA主成分分析）"></a>1.详细介绍EOF分析方法（也称PCA主成分分析）</h2><p>经验正交函数（Empirical Orthogonal Functions，EOFs）方法最早是由统计学家Pearson在1902年提出的，之后由Lorenz（1956）引入气象问题分析当中。机器学习领域常称作主成分分析（Principal Component Analysis，PCA）。</p>
<p>EOF分析是将一个气象场分解为一个空间函数和一个时间函数的乘积，即 <strong>X = VZ</strong> 的形式<br>其中，<strong>X</strong> 是气象场，<strong>V</strong> 是空间函数，<strong>Z</strong> 是时间函数</p>
<span id="more"></span>
<p>如果我们将一个气象场的多次观测值记为</p>
<img src="EOF1.png" width=256/>

<p>其中，下标 <strong>m</strong> 表示不同站点或不同格点，下标 <strong>n</strong> 表示时间<br>那么存在这样一个时间函数 <strong>V</strong> 和空间函数 <strong>Z</strong> </p>
<img src="EOF2.png" width=256/>
<img src="EOF3.png" width=256/>

<p>使得 <strong>X = VZ</strong>， 即</p>
<img src="EOF4.png" width=400/>

<p>其中 <em><strong>i = 1,2,…,m</strong></em> <em><strong>t = 1,2,…,n</strong></em> 表示变量场中第 <em><strong>i</strong></em> 个格点上的第 <em><strong>t</strong></em> 次观测值，可以看做是p个空间函数 $v_{ik}$ 和时间函数 $z_{ki}$ 的线性组合</p>
<p>因此 <strong>t</strong> 时刻的空间场可以表示为</p>
<img src="EOF5.png" width=400/>

<p>或者</p>
<img src="EOF6.png" width=400/>

<p>其中</p>
<img src="EOF7.png" width=300/>

<p>是第 <strong>j</strong> 个典型场，如果令</p>
<img src="EOF8.png" width=300/>

<p>那么我们就得到气象场的表达式为</p>
<img src="EOF9.png" width=400/>

<p>其中 $V_j$ 就称为 <strong>X</strong> 的EOF第 <strong>j</strong> 模态，$Z_j$ 就称为第 <strong>j</strong> 模态的时间序列</p>
<h2 id="2-EOF分解的计算"><a href="#2-EOF分解的计算" class="headerlink" title="2.EOF分解的计算"></a>2.EOF分解的计算</h2><p>我们知道</p>
<img src="EOF10.png" width=300/>

<p>令</p>
<img src="EOF11.png" width=200/>

<p>显然矩阵 $A_{m{\times}m}$ 是一个实对称矩阵，由实对称矩阵的性质， $A_{m{\times}m}$ 可被正交相似对角化</p>
<p>即存在正交矩阵 $P_{m{\times}m}$ 使得 $P^TAP = \Lambda$, 其中 $\Lambda_{m{\times}m}$ 为矩阵 $X_{m{\times}n}$ 特征值组成的对角矩阵</p>
<img src="EOF12.png" width=300/>

<p>计算矩阵 $A_{m{\times}m}$ 的特征值 $\lambda_{1,…,m}$ 以及特征向量 $V_{m{\times}m}$</p>
<p>将特征向量 $V_{m{\times}m}$ 按特征值从大到小排序，第一个特征向量，也即 $V_{m{\times}m}$ 的第1列为<label style="color:red">第1个EOF模态</label></p>
<p>以此类推，第 <em><strong>2,3,…,p</strong></em> 列对应<label style="color:red">第p个EOF模态</label></p>
<p>我们将特征向量 $V_{m{\times}m}$ 作为气象场 $X_{m{\times}n}$ 的空间函数</p>
<p>那么，气象场 $X_{m{\times}n}$ 的时间矩阵 $Z_{m{\times}n} = V_{m{\times}m}^T{\times}X_{m{\times}n}$</p>
<p>对应的 $Z_{m{\times}n}$ 每行数据就是对应每个特征向量的时间系数，<label style="color:red">第一行就是第一个EOF模态的时间系数</label>，其他类推</p>
<p>这样，我们就将 $X_{m{\times}n}$ 分解成了空间函数 $V_{m{\times}m}$ 和时间函数 $Z_{m{\times}n}$ 的乘积</p>
<p>此时，$V_{m{\times}m}$ 满足</p>
<img src="EOF13.png" width=300/>

<p>$Z_{m{\times}n}$ 满足</p>
<img src="EOF14.png" width=300/>

<p>也即<strong>“正交”</strong>的由来</p>
]]></content>
      <categories>
        <category>统计学</category>
      </categories>
      <tags>
        <tag>EOF</tag>
      </tags>
  </entry>
</search>
